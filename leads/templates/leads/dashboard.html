<!DOCTYPE html>
<html>
<head>
  <title>Django CRM Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-4">
  <h2>CRM Summary Dashboard</h2>
  <a href="/admin/" class="btn btn-secondary mb-4">Back to Admin</a>
  <div class="row text-center mb-4">
    <div class="col-md-6">
      <div class="card p-3 shadow-sm">
        <h4>Total Leads</h4>
        <h2>{{ total }}</h2>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card p-3 shadow-sm">
        <h4>Leads Closed</h4>
        <h2>{{ closed }}</h2>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <h5 class="text-center">Closed vs Open Leads</h5>
      <canvas id="leadPieChart"></canvas>
    </div>
  </div>
</div>
<script>
  const pieLabels = {{ pie_data.labels|safe }};
  const pieValues = {{ pie_data.values|safe }};
  new Chart(document.getElementById("leadPieChart"), {
    type: "pie",
    data: {
      labels: pieLabels,
      datasets: [{
        label: "Leads",
        data: pieValues
      }]
    }
  });
</script>
</body>
</html>
